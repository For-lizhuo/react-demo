---
title: 瀑布流布局
nav:
  title: demo
  path: /common
group:
  title: 交互
---

# 瀑布流布局

## 介绍

瀑布流布局（Waterfall Layout）是一种常见的网页布局方式，通常用于展示图片或卡片式内容。其特点是将内容以多列的方式依次排列，犹如瀑布般从上至下流动。这种布局能够有效利用页面空间，展示更多内容，并且在移动设备上也有良好的适应性。

下图是小红书网页版使用到的瀑布流布局。

![小红书网页版瀑布流布局](./image.png)

## 优点

1. 有效利用空间： 瀑布流布局可以充分利用页面空间，无论是横向还是纵向滚动，都可以容纳很多项目，用于展示大量内容或产品效果很好。
2. 自适应性： 瀑布流布局可以适应不同屏幕大小和设备类型，因为它是响应式设计的一部分，这意味着它可以在桌面电脑、平板电脑和移动设备上都有良好的表现。
3. 提高用户参与度： 用户通常更愿意探索页面上的不同项目，因为每次滚动都可能带来新的发现，从而增加了用户的参与度和浏览时间。

## 实现方案

- 确定容器布局属性为`display: relative`，图片布局属性为`display: absolute`，需要依次计算每个图片的`top`和`left`属性值。
- 计算整个容器的宽度和每个图片的宽度（通常每个图片的宽度相同），计算出一行最多能够排列的图片数量。
- 维护一个数组，保存每一列当前占据的高度，初始值均为 0。
- 对于放置在第一行的图片只需要按顺序排列，当第一行排列满后，每张图片需要找到当前布局中占据高度最小的一列（数组的最小值的下标），将当前图片放置在该列。
- 计算出图片放置的位置后，更新数组，将图片高度添加到图片所在列对应的数组值。
- 监听`window`对象的`resize`事件（添加节流），当视窗的大小改变时，由于容器宽度的变化，需要重新计算图片的排列位置。

## 示例

<code src="./index.tsx"></code>
